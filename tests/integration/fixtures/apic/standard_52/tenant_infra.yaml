---
apic:
  tenants:
    - name: infra
      sr_mpls_l3outs:
        - name: INFRA_SR_MPLS_L3
          description: Infra SR-MPLS L3out
          domain: ROUTED1
          transport_data_plane: mpls 
          node_profiles:
            - name: SR_MPLS_NP
              mpls_custom_qos_policy: MPLS_QOS
              bfd_multihop_node_policy: BFD_POL
              nodes: 
                - node_id: 101
                  router_id: 126.126.126.126
                  bgp_evpn_loopback: 127.31.2.26
                  mpls_transport_loopback: 172.31.2.26
                  segment_id: 206
              evpn_connectivity:
                - ip: 172.31.2.54
                  remote_as: 64001
                  ttl: 10
                  local_as: 31200
                  allow_self_as: true
                  disable_peer_as_check: true 
                  password: C1sco123
                  as_propagate: dual-as
                  peer_prefix_policy: BGP_PP1
              interface_profiles:
                - name: int_prof 
                  bfd_policy: BFD_POL
                  interfaces:
                    - node_id: 101
                      port: 10
                      mtu: 9000
                      ip: 5.5.5.5/24
                      bgp_peers:
                        - ip: 10.10.10.1
                          remote_as: 65123
                    - node_id: 102
                      channel: PC1
                      vlan: 101
                      ip: 6.6.6.6/24
      policies:
        bfd_interface_policies:
          - name: BFD_POL
        bgp_peer_prefix_policies:
          - name: BGP_PP1
            description: 'My BGP PP Policy 1'
            action: 'shut'
            threshold: 90
            max_prefixes: 10000
        mpls_custom_qos_policies:
          - name: MPLS_QOS_POL
            description: Custom MPLS QoS Policy
            ingress_rules:
              - priority: level1
                exp_from: 1
                exp_from: 2
                dscp_target: AF11
                cos_target: 0
            egress_rules:
              - dscp_from: af11
                dscp_to: af12
                exp_target: 0
                cos_target: 0
        bfd_multihop_node_policies:
          - name: BFD_MHOP_POL
            description: BFD multihop node policy
            detection_multiplier: 5
            min_rx_interval: 300
            min_tx_interval: 300